<div class="dashboard-container">
  
  <!-- 1️⃣ Top Section: Greeting & Title -->
  <div class="greeting-section">
    <h1 class="greeting-title">{{ greeting }}</h1>
    <p class="greeting-subtitle">{{ subtitle }}</p>
  </div>

  <!-- 2️⃣ Middle Section: Summary Cards -->
  <div class="summary-cards-grid" @staggerCards>
    <div class="stat-card" *ngFor="let card of summaryCards">
      <div class="stat-card-header">
        <div class="stat-icon-wrapper" [style.background]="card.color + '20'">
          <span class="material-icons stat-icon" [style.color]="card.color">{{ card.icon }}</span>
        </div>
        <div class="stat-trend" *ngIf="card.trend" [class.trend-up]="card.trendUp" [class.trend-down]="!card.trendUp">
          <span class="material-icons trend-icon">{{ card.trendUp ? 'trending_up' : 'trending_down' }}</span>
          <span class="trend-text">{{ card.trend }}</span>
        </div>
      </div>
      <div class="stat-card-body">
        <h2 class="stat-value">{{ card.value }}</h2>
        <p class="stat-label">{{ card.title }}</p>
      </div>
    </div>
  </div>

  <!-- 3️⃣ Bottom Section: Charts & Lists -->
  
  <!-- ADMIN VIEW -->
  <div class="data-section" *ngIf="isAdmin">
    <div class="data-grid">
      
      <!-- Bar Chart: Tasks by Service -->
      <div class="chart-card">
        <div class="card-header">
          <h3 class="card-title">
            <span class="material-icons">bar_chart</span>
            Tâches par service
          </h3>
        </div>
        <div class="chart-container">
          <div class="bar-chart">
            <div class="bar-item" *ngFor="let item of chartData">
              <div class="bar-wrapper">
                <div class="bar-fill" 
                     [style.height]="getChartHeight(item.value)"
                     [style.background]="item.color || '#42A5F5'">
                  <span class="bar-value">{{ item.value }}</span>
                </div>
              </div>
              <p class="bar-label">{{ item.label }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent Activity Table -->
      <div class="table-card">
        <div class="card-header">
          <h3 class="card-title">
            <span class="material-icons">history</span>
            Activité récente
          </h3>
        </div>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>Employé</th>
                <th>Tâche</th>
                <th>Statut</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let task of taskList">
                <td>{{ task.employee }}</td>
                <td>{{ task.task }}</td>
                <td><span class="status-badge" [ngClass]="getStatusClass(task.status)">{{ task.status }}</span></td>
                <td>{{ task.date }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- CHEF DE SERVICE VIEW -->
  <div class="data-section" *ngIf="isChef">
    <div class="data-grid">
      
      <!-- Line Chart: Weekly Progress -->
      <div class="chart-card">
        <div class="card-header">
          <h3 class="card-title">
            <span class="material-icons">show_chart</span>
            Progression hebdomadaire
          </h3>
        </div>
        <div class="chart-container">
          <div class="line-chart">
            <div class="line-item" *ngFor="let item of chartData">
              <div class="line-wrapper">
                <div class="line-fill" 
                     [style.height]="getChartHeight(item.value)">
                  <span class="line-value">{{ item.value }}</span>
                </div>
              </div>
              <p class="line-label">{{ item.label }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Validation Tasks Table -->
      <div class="table-card">
        <div class="card-header">
          <h3 class="card-title">
            <span class="material-icons">assignment_turned_in</span>
            Tâches en attente de validation
          </h3>
        </div>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>Employé</th>
                <th>Tâche</th>
                <th>Statut</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let task of taskList">
                <td>{{ task.employee }}</td>
                <td>{{ task.task }}</td>
                <td><span class="status-badge" [ngClass]="getStatusClass(task.status)">{{ task.status }}</span></td>
                <td>
                  <button class="action-btn" *ngIf="task.status === 'À valider'" [routerLink]="['/chef/validation']">
                    <span class="material-icons">check</span>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- EMPLOYE VIEW -->
  <div class="data-section" *ngIf="isEmploye">
    <div class="data-grid employe-grid">
      
      <!-- Progress Circle -->
      <div class="progress-card">
        <div class="card-header">
          <h3 class="card-title">
            <span class="material-icons">donut_large</span>
            Progression personnelle
          </h3>
        </div>
        <div class="progress-container">
          <div class="circular-progress">
            <svg class="progress-ring" width="180" height="180">
              <defs>
                <linearGradient id="progressGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" stop-color="#1565C0" />
                  <stop offset="100%" stop-color="#42A5F5" />
                </linearGradient>
              </defs>
              <circle class="progress-ring-bg" cx="90" cy="90" r="70" />
              <circle class="progress-ring-fill" 
                      cx="90" cy="90" r="70"
                      [style.stroke-dashoffset]="440 - (440 * progressValue / 100)" />
            </svg>
            <div class="progress-text">
              <span class="progress-value">{{ progressValue }}%</span>
              <span class="progress-label">Complété</span>
            </div>
          </div>
          <div class="progress-info">
            <div class="info-item">
              <span class="material-icons">assignment</span>
              <span>{{ summaryCards[0].value }} tâches actives</span>
            </div>
            <div class="info-item">
              <span class="material-icons">check_circle</span>
              <span>{{ summaryCards[1].value }} tâches terminées</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Tasks Timeline -->
      <div class="timeline-card">
        <div class="card-header">
          <h3 class="card-title">
            <span class="material-icons">timeline</span>
            Mes activités récentes
          </h3>
        </div>
        <div class="timeline-container">
          <div class="timeline-item" *ngFor="let task of taskList">
            <div class="timeline-marker" [ngClass]="getStatusClass(task.status)"></div>
            <div class="timeline-content">
              <h4 class="timeline-title">{{ task.task }}</h4>
              <div class="timeline-meta">
                <span class="status-badge" [ngClass]="getStatusClass(task.status)">{{ task.status }}</span>
                <span class="timeline-date">{{ task.date }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 4️⃣ Quick Actions Area -->
  <div class="quick-actions-section">
    <h3 class="actions-title">Actions rapides</h3>
    <div class="actions-grid">
      <button class="action-card" *ngFor="let action of quickActions" [routerLink]="[action.route]">
        <span class="material-icons action-icon">{{ action.icon }}</span>
        <span class="action-label">{{ action.label }}</span>
        <span class="material-icons action-arrow">arrow_forward</span>
      </button>
    </div>
  </div>

</div>